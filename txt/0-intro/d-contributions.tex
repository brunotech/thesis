%!TEX root = ../../THESIS.tex

\section*{Contributions}
\addcontentsline{toc}{section}{Contributions}

The first chapter is an extended version of the DisCoPy paper~\cite{FeliceEtAl20a}.
It emerged from a dialectic teacher-student collaboration with Giovanni de Felice: implementing our own category theory library was a way to teach him Python programming.
Bob Coecke then added the capital letters to the name of DisCoPy.
We list the contributions of each section.

\begin{enumerate}
\item We\footnote
{The ``we'' of this section refers to the author of this thesis.
Although we believe that science is collaboration and that the notion of personal contribution is obsolete, it is in fact required by university regulations: ``Where some part of the thesis is not solely the work of the candidate or has been carried out in collaboration with one or more persons, the candidate shall submit a clear statement of the extent of his or her own contribution.''}
give an introduction to elementary category theory for the Python programmer which is at the same time an introduction to object-oriented programming for the applied category theorist.
This includes an implementation of:
\begin{itemize}
    \item the category $\mathbf{Pyth}$ with Python types as objects and functions as arrows (listing~\ref{listing:Function}),
    \item the category $\mathbf{Mat}_\S$ with natural numbers as objects and matrices with entries in a rig $\S$ as arrows (listing~\ref{listing:matrix}),
    \item free categories (listing~\ref{listing:cat.py}) with quantum circuits as example (\ref{example:Circuit}),
    \item the category $\mathbf{Cat}$ with categories as objects and functors as arrows (listing~\ref{listing:Functor}),
    \item quotient categories (section~\ref{subsection:quotient-categories}),
    \item categories with a dagger structure, i.e. an identity-on-objects contravariant involutive endofunctor (section~\ref{subsection:dagger-sums-bubbles}),
    \item categories with sums, i.e. enriched in commutative monoids, and bubbles, i.e. arbitrary unary operators on homsets, with the example of neural networks (\ref{example:neural-net}) and propositional logic (\ref{example:propositional-logic}).
\end{itemize}

\item We give an elementary definition of string diagrams for monoidal categories.
Our construction decomposes the free monoidal category construction into three basic steps: 1) a layer endofunctor on the category of monoidal signatures, 2) the free premonoidal category as a free category of layers and 3) the free monoidal category as a quotient by interchangers.
To the best of our knowledge, this \emph{premonoidal approach} had been relegated to mathematical folklore: it was known by those who knew it, yet it never appeared in print.
The monoidal categories we implement are all strict and furthermore they are \emph{free on objects} (foo), lemma~\ref{lemma:foo-monoidal} shows that every monoidal category is monoidally equivalent to a foo one.
This includes:
\begin{itemize}
    \item $\mathbf{Pyth}$ with lists of types as objects and tupling as tensor (listing~\ref{listing:monoidal.Function}),
    \item $\mathbf{Tensor}_\S \simeq \mathbf{Mat}_\S$ with lists of natural numbers as objects and Kronecker product as tensor (listing~\ref{listing:tensor}),
    \item free monoidal categories (listing~\ref{listing:monoidal.Diagram}) with quantum circuits as example (\ref{example:circuit-diagrams}),
    \item quotient monoidal categories (listing~\ref{subsection:quotient-monoidal}) with quantum circuit optimisation as example (\ref{example:simplify-circuits}),
    \item monoidal categories with daggers, sums and bubbles (section~\ref{subsection:monoidal-daggers-sums-bubbles}) with the example of post-processed quantum circuits (\ref{example:postprocessed-circuit}) and first-order logic Ã  la Peirce (\ref{example:monoidal-formula}).
\end{itemize}
DisCoPy uses a \emph{point-free} or \emph{tacit programming} style where diagrams are described only by composition and tensor.
We discuss how to go from tacit to explicit programming, defining diagrams using the standard syntax for Python functions (section~\ref{subsection:tacit-to-explicit}).

\item We prove the equivalence between our elementary definition of diagrams in terms of list of layers and the topological definition in terms of \emph{labeled generic progressive plane graphs}.
One side of this equivalence underlies the drawing algorithm of DisCoPy, the other side is the basis of a prototype for an automatic diagram recognition algorithm.
We then discuss how to extend this to non-generic, non-progressive, non-planar, non-graph-like diagrams, which opens the door to the next section.

\item We describe our object-oriented implementation of monoidal categories with extra structure.
The hierarchy of categorical structures (monoidal, closed, rigid, etc.) is encoded in a hierarchy of Python classes and an inheritance mechanism implements the free-forgetful adjunctions between them.
This includes an implementation of:
\begin{itemize}
\item free rigid categories, for which we introduce the \emph{snake removal} algorithm to compute normal forms (section~\ref{subsection:rigid}),
\item the syntax for diagrams in free braided, symmetric, tortile and compact-closed categories (section~\ref{subsection:symmetric}),
\item the syntax for diagrams in free hypergraph categories, i.e. with coherent special commutative Frobenius algebras on each object (section~\ref{subsection:hypergraph}),
\item the syntax for diagrams in free cartesian and cocartesian diagrams (section~\ref{subsection:cartesian}) with $\mathbf{Pyth}$ as an example of a \emph{rig category} with two monoidal structures (listing~\ref{listing:python-co-cartesian}),
\item the free biproduct completion as the category of matrices with arrows as entries (section~\ref{subsection:biproducts}), taking quantum measurements as example (\ref{example:biproduct-measurement}),
\item the syntax for diagrams in closed monoidal categories (section~\ref{subsection:closed}) with currying of functions in $\mathbf{Pyth}$ as example (\ref{example:closed-function}),
\item an implementation of $\mathbf{Pyth}$ as a traced cartesian and cocartesian category (listing~\ref{listing:traced-python}) and $\mathbf{Mat}_\B \simeq \mathbf{FinRel}$ as a traced biproduct category (listing~\ref{listing:traced-matrix}).
\end{itemize}

\item We discuss the relationship between our premonoidal approach and the existing graph-based data structures for diagrams in symmetric monoidal categories.
This includes:
\begin{itemize}
\item a comparison between our definition of \emph{premonoidal diagrams} as lists of layers and the free premonoidal category as a state construction over a monoidal category (section~\ref{subsection:state-construction}),
\item an implementation of \emph{hypergraph diagrams}, i.e. the arrows of free hypergraph categories, and the subcategories of compact, traced and symmetric diagrams (section~\ref{subsection:hypergraph-vs-premonoidal}),
\item an implementation of free sesquicategories (i.e. 2-categories without interchangers) with \emph{coloured diagrams} as 2-cells (listing~\ref{listing:free-sesquicategory}),
\item an implementation of $\mathbf{Cat}$ as a sesquicategory with (not-necessarily-natural) transformations as 2-cells (listing~\ref{listing:Transformation}),
\item an implementation of free monoidal 2-categories with diagrams as 1-cells and rewrites as 2-cells (listing~\ref{listing:free-monoidal-2-category}).
\end{itemize}
\end{enumerate}
The second chapter deals with QNLP, building on \cite{MeichanetzidisEtAl20,CoeckeEtAl20,MeichanetzidisEtAl20a}.
It was joint work with Bob Coecke, Giovanni de Felice and Konstantinos Meichanetzidis.
\begin{itemize}
\item Section~\ref{section:NLP} gives a very short introduction to QNLP, from Chomskyan grammars and ambiguity (\ref{subsection:chomsky}) to DisCocat models via the Lambek calculus and Montague semantics (\ref{subsection:lambek-discocat}).
We conclude with a discussion of previous work on anaphora and the quantum complexity of language (\ref{section:anaphora}).
\item Section~\ref{section:discocat-qnlp} defines QNLP models as functors from grammar to quantum circuits and show that any DisCoCat model can be implemented in this way.
We discuss our implementation of classical-quantum channels and mixed quantum circuits (\ref{section:mixed-circuits}) and the use of our snake removal algorithm to reduce both the number of qubits and the amount of post-selection required for QNLP models (\ref{subsection:snake-removal}).
\item We review previous implementations of DisCoCat models and study their relationship with \emph{knowledge graph embeddings} (\ref{subsection:kge}) and  hybrid classical-quantum algorithm to train QNLP models on a question-answering task (\ref{subsection:vqqa}).
The underlying idea of \emph{functorial learning}, i.e. learning structure-preserving functors from diagram-like data, provides a theoretical framework for machine learning on structured data.
\end{itemize}
The last section has been published in joint work with Richie Yeung and Giovanni de Felice~\cite{ToumiEtAl21a}.
It introduces \emph{diagrammatic differentiation}, a graphical calculus for computing the gradients of parameterised diagrams which applies to the training of QNLP models but also to functorial learning in general.
\begin{itemize}
\item In section~\ref{2-dual-diagrams}, we generalise the dual number construction from rings to monoidal categories. Dual diagrams are formal sums of a string diagram (the real part) and its derivative with respect to some parameter (the epsilon part).
We use bubbles to encode differentiation of diagrams and express the standard rules of calculus (linearity, product, chain) entirely in terms of diagrams.
\item In section~\ref{2b-differentiating-zx}, we study diagrammatic differentiation for the ZX calculus.
This allows to compute the gradients of linear maps with respect to phase parameters.
\item In section~\ref{3-dual-circuits}, we look at the diagrammatic differentiation of mixed quantum circuits, this yields a definition of the parameter-shift rules used in quantum machine learning.
\item In section~\ref{4-bubbles}, we define the gradient of diagrams with bubbles in terms of the chain rule. This allows to differentiate quantum circuits with neural networks as classical post-processing.
\end{itemize}

\section*{Publications}
\addcontentsline{toc}{section}{Publications}

The material presented in this thesis builds on the following publications.
\begin{itemize}[label={}]
\item \enumcite{MeichanetzidisEtAl20a}\vspace{-10pt}
\item \enumcite{FeliceEtAl20a}\vspace{-10pt}
\item \enumcite{CoeckeEtAl20}\vspace{-10pt}
\item \enumcite{MeichanetzidisEtAl20}\vspace{-10pt}
\item \enumcite{KartsaklisEtAl21}\vspace{-10pt}
\item \enumcite{ToumiEtAl21a}
\end{itemize}\vspace{10pt}
During his DPhil, the author has also published the following articles.
\begin{itemize}[label={}]
\item \enumcite{BorosEtAl19}\vspace{-10pt}
\item \enumcite{FeliceEtAl19}\vspace{-10pt}
\item \enumcite{FeliceEtAl20}\vspace{-10pt}
\item \enumcite{ShieblerEtAl20}\vspace{5pt}
\item \enumcite{ToumiKoziell-Pipe21}\vspace{5pt}
\item \enumcite{CoeckeEtAl21}\vspace{-10pt}
\item \enumcite{McPheatEtAl21}\vspace{-10pt}
\end{itemize}

\section*{Outreach}
\addcontentsline{toc}{section}{Outreach}

The content of this thesis has also been the subject of science popularisation aimed at a wide audience.

\begin{itemize}
\item A blog post summarising our first experiment and two podcasts with long discussions on the topic.
\end{itemize}
\begin{itemize}[label={}]
\item \enumcite{CoeckeEtAl20b}\vspace{-10pt}
\item \enumcite{FuturatiPodcast21}\vspace{-10pt}
\item \enumcite{MachineLearningStreetTalk21}\vspace{-10pt}
\end{itemize}

\begin{itemize}
\item Two invited lectures at the TalTech \emph{Compositional Systems and Methods} group.
\end{itemize}
\begin{itemize}[label={}]
\item \enumcite{ToumiFelice21}\vspace{-10pt}
\item \enumcite{ToumiFelice21a}\vspace{-10pt}
\end{itemize}

\begin{itemize}
\item A presentation at an educational event for programmers and data scientists.
\end{itemize}
\begin{itemize}[label={}]
\item \enumcite{PyD20}
\end{itemize}

\begin{itemize}
\item A hackathon where students implemented QNLP experiments with DisCoPy.
\end{itemize}
\begin{itemize}[label={}]
\item \enumcite{Molina21}\vspace{-10pt}
\end{itemize}

\begin{itemize}
\item A press release explaining QNLP in plain English.
\end{itemize}
\begin{itemize}[label={}]
\item \enumcite{TQI20}\vspace{-10pt}
\end{itemize}

\begin{itemize}
\item Press releases introducing lambeq~\cite{KartsaklisEtAl21} to a business audience.
\end{itemize}
\begin{itemize}[label={}]
\item \enumcite{HPC21}\vspace{-10pt}
\item \enumcite{Smith-Goodson21}\vspace{-10pt}
\end{itemize}
